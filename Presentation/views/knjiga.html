%rebase('osnova.html', naslov='Podrobnosti knjige', stran='knjiga')

<div class="knjiga-container">
    <h1 class="knjiga-naslov">{{knjiga.naslov}}</h1>

    <p>Avtorji: {{ ", ".join([a.ime + " " + a.priimek for a in knjiga.avtorji]) }}</p>

    <p>Žanri: {{ ", ".join([z.ime_zanra for z in knjiga.zanri]) }}</p>


    <p class="knjiga-razpolozljivost">
        Razpoložljivost: {{knjiga.razpolozljivost}}
    </p>

    % if knjiga.razpolozljivost == 'na voljo':
        <form action="/izposodi/{{knjiga.id_knjige}}" method="post">
            <button type="submit" class="btn btn-primary">Izposodi knjigo</button>
        </form>
    % end

    <hr>

    % if request.query.get('uspesno'):
        <p class="alert alert-success">Hvala! Vaša ocena je bila uspešno oddana.</p>
    % end

    <h2>Povprečna ocena:
        % if povprecna_ocena is not None:
            {{povprecna_ocena}} / 5
        % else:
            Ni ocen
        % end
    </h2>

    <hr>
    <h3>Ocene in komentarji</h3>
    % if ocene:
        <ul class="ocene-lista">
            % for o in ocene:
                <li>
                    Ocena: {{o.ocena}} / 5<br>
                    Komentar: {{o.komentar if o.komentar else "Brez komentarja"}}<br>
                    Datum: {{o.datum}}
                </li>
            % end
        </ul>
    % else:
        <p>Še ni ocen.</p>
    % end

    <hr>
    <h3>Dodaj svojo oceno</h3>
    <form action="/dodaj_oceno/{{knjiga.id_knjige}}" method="post" class="dodaj-oceno-form">
        <div class="form-group">
            <label>Ocena (1-5)</label>
            <input type="number" name="ocena" min="1" max="5" required>
        </div>
        <div class="form-group">
            <label>Komentar</label>
            <textarea name="komentar"></textarea>
        </div>
        <button type="submit" class="btn btn-secondary">Dodaj oceno</button>
    </form>

    <hr>
    <a href="/home" class="btn btn-secondary">Nazaj na domačo stran</a>
</div>
